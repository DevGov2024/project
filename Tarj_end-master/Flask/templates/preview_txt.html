
{% extends "base.html" %}

{% block title %}Página Inicial - STGC{% endblock %}

{% block content %}
 
    <div class="row justify-content-center">
      <section class="col-md-9">
        <div class="bg-white p-4 rounded-3 shadow-sm text-center">
          <h3 class="mb-3"><i class="bi bi-patch-check-fill text-success"></i> Documento Tarjado com Sucesso!</h3>
          <p class="text-muted">Abaixo está a pré-visualização do seu documento com as tarjas aplicadas. Você
                        pode ajustar as tarjas antes de baixar.</p>
          <hr>

          <!-- Conteúdo adaptado do TXT -->
          <form method="post" action="/aplicar_tarjas_txt" class="text-start">
            <h5 class="mb-3">Visualização do conteúdo com marcações:</h5>
            <div class="border rounded bg-light p-3 mb-4"
              style="white-space: pre-wrap; max-height: 400px; overflow-y: auto;">
              {% set offset = 0 %}
              {% for item in ocorrencias %}
              {% set start = item.start + offset %}
              {% set end = item.end + offset %}
              {% set texto = conteudo[start:end] %}
              {{ conteudo[offset:start] }}
              <mark>{{ texto }}</mark>
              {% set offset = end %}
              {% endfor %}
              {{ conteudo[offset:] }}
            </div>

            <h5 class="mb-2">Dados encontrados:</h5>
            {% for item in ocorrencias %}
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="selecionados" value="{{ item.id }}"
                id="ocorrencia{{ item.id }}" checked>
              <label class="form-check-label" for="ocorrencia{{ item.id }}">{{ item.tipo }} — {{ item.texto }}</label>
            </div>
            {% endfor %}

          <div class="d-flex justify-content-center align-items-center mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-shield-fill-x me-2"></i>Aplicar Tarjas e Fazer Download
                        </button>

              <a href="{{ url_for('homepage') }}" class="btn btn-secondary btn-lg">
                <i class="bi bi-house-door-fill me-2"></i>Cancelar Solicitação</a>
            </div>
          </form>
        </div>
      </section>
    </div>
 

 {% endblock %}