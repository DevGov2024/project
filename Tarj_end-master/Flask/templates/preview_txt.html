<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pré-visualização do Documento Tarjado</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="static/css/style.css"> 
</head>

<body>
<header>
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand" href="index.html">
            <img src="static/img/brasao-sp.png" alt="Logo da Prefeitura" style="width: 150px;">
        <span>STGC - Sistema de Tarjamento da Gestão/COTIC</span>
      </a>
    </div>
  </nav>

  <div class="sub-navbar">
    <div class="container">
      <a href="https://prefeitura.sp.gov.br/">Prefeitura de São Paulo</a>
      <span class="mx-2">&rsaquo;</span>
      <a href="https://prefeitura.sp.gov.br/web/gestao/">Secretaria Municipal da Gestão</a>
      <span class="mx-2">&rsaquo;</span>
      <a href="https://prefeitura.sp.gov.br/web/gestao/w/coordenadoria-de-tecnologia-da-informa%C3%A7%C3%A3o-e-comunica%C3%A7%C3%A3o-cotic">Coordenadoria de Tecnologia da Informação e Comunicação</a>
      <span class="mx-2">&rsaquo;</span>
      <a href="https://prefeitura.sp.gov.br/web/gestao/w/lei-geral-de-prote%C3%A7%C3%A3o-de-dados-lgpd-">LGPD</a>
    </div>
  </div>
</header>

<main class="container my-5">
  <div class="row justify-content-center">
    <section class="col-md-9">
      <div class="bg-white p-4 rounded-3 shadow-sm text-center">
        <h3 class="mb-3"><i class="bi bi-patch-check-fill text-success"></i> Documento Tarjado com Sucesso!</h3>
        <p class="text-muted">Abaixo está a pré-visualização do seu documento com as tarjas aplicadas. Você pode revisar os dados identificados antes de confirmar.</p>
        <hr>

        <!-- Conteúdo adaptado do TXT -->
        <form method="post" action="/aplicar_tarjas_txt" class="text-start">
          <h5 class="mb-3">Visualização do conteúdo com marcações:</h5>
          <div class="border rounded bg-light p-3 mb-4" style="white-space: pre-wrap; max-height: 400px; overflow-y: auto;">
            {% set offset = 0 %}
            {% for item in ocorrencias %}
              {% set start = item.start + offset %}
              {% set end = item.end + offset %}
              {% set texto = conteudo[start:end] %}
              {{ conteudo[offset:start] }}
              <mark>{{ texto }}</mark>
              {% set offset = end %}
            {% endfor %}
            {{ conteudo[offset:] }}
          </div>

          <h5 class="mb-2">Selecionar dados que deseja tarjar:</h5>
          {% for item in ocorrencias %}
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="selecionados" value="{{ item.id }}" id="ocorrencia{{ item.id }}" checked>
              <label class="form-check-label" for="ocorrencia{{ item.id }}">{{ item.tipo }} — {{ item.texto }}</label>
            </div>
          {% endfor %}

          <div class="d-flex justify-content-center align-items-center mt-4">
            <button class="btn btn-danger btn-lg me-3" type="submit">
              <i class="bi bi-shield-lock-fill me-2"></i>Confirmar e Tarjar
            </button>
            <a href="index.html" class="btn btn-secondary btn-lg">
              <i class="bi bi-house-door-fill me-2"></i>Voltar para o Início
            </a>
          </div>
        </form>
      </div>
    </section>
  </div>
</main>

<footer class="text-center p-4 mt-5">
  Copyright © Prefeitura de São Paulo - SEGES/COTIC 2025
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

