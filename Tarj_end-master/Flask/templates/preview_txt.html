<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Pré-visualização do TXT</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
  <h2 class="mb-4">Pré-visualização do conteúdo</h2>
  <form method="post" action="/aplicar_tarjas_txt">
    <div class="border p-3 mb-4" style="white-space: pre-wrap; background-color: #f8f9fa;">
      {% set offset = 0 %}
      {% for item in ocorrencias %}
        {% set start = item.start + offset %}
        {% set end = item.end + offset %}
        {% set texto = conteudo[start:end] %}
        {{ conteudo[offset:start] }}
        <mark>{{ texto }}</mark>
        {% set offset = end %}
      {% endfor %}
      {{ conteudo[offset:] }}
    </div>

    <h5>Selecionar dados que deseja tarjar:</h5>
    {% for item in ocorrencias %}
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="selecionados" value="{{ item.id }}" checked>
        <label class="form-check-label">{{ item.tipo }} — {{ item.texto }}</label>
      </div>
    {% endfor %}
    <br>
    <button class="btn btn-danger" type="submit">Confirmar e Tarjar</button>
  </form>
</div>
</body>
</html>
